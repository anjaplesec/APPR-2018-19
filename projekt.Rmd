---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Anja Plesec"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Analiza brezposelnosti

V tem projektu bom obravnavala brezposelnost v Sloveniji. Analizirala bom brezposelnost glede na starost, spol in izobrazbo ter glede na statistične regije v Sloveniji. Za na konec bom primerjala brezposelnost po slovenskih občinah ter brezposelnost v Sloveniji v primerjavi z drugimi evropskimi državami.

![](slike/brezposelnost.jpg)

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE, warning=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke sem pridobila iz spletne strani Statističnega urada Republike Slovenije(SURS) in iz Eurostat-a. Vsi podatki so v okliki CSV. 

Podatke imam v razpredelnicah v obliki *tidy data*.


1. `brezposelnost_izo` - podatki o brezposelnosti glede na izobrazbo
   - `leto` - spremenljivka: pove nam, katero leto opazujemo
   - `spol` - spremenljivka: spol brezposelnega
   - `izobrazba` - spremenljivka: stopnja izobrazbe brezposelne osebe
   - `stevilo` - spremenljivka: pove nam število brazposelnih pri določeni izobrazbi
  
2. `brezposelni` - podatki o brezposelnosti glede na starost in spol
   - `leta` - spremenljivka: pove nam, katero leto opazujemo
   - `spol` - spremenljivka: pove nam spol brezposelnega
   - `stevilo` - spremenljivka: pove nam število brezposelnih glede na spol in leto

3. `trajanje_brezposelnosti` - podatki o trajanju brezposelnosti
   - `trajanje` - spremenljivka: pove nam, koliko časa je oseba že brezposelna
   - `spol` - spremenljivka: spol brezposelnega
   - `leta` - spremenljivka: pove nam, katero leto opazujemo
   - `stevilo` - spremenljivka: pove nam število brezposelnih

4. `tip_gospodinjstva` - podatki o trajnaju brezposelnosti glede na tip gospodinjstva
   - `leto` - spremenljivka: pove nam, katero leto opazujemo
   - `gospodinjstvo` - spremenljivka: pove nam kakšnega tipa je gospodinjstvo(Enočlansko gospodinjstvo, Samohranilec, Par brez otrok,..)
   - `stevilo` - spremenljivka: pove nam število brezposelnih, glede na tip gospodinjstva


5. `statistične_regije` - podatki o brezposelnosti v posamezni statistični regiji Slovenije
   - `regija` - spremenljivka: pove nam katero statistično regijo opazujemo(Koroška, Posavska, Goriška,..)
   - `leto` - spremenljivka: pove nam, katero leto opazujemo
   - `stevilo` - spremenljivka: pove nam število brezposelnih, glede na posamezno statistično regijo
   

6. `brezposelnost_drzave` - podatki o brezposelnosti v posameznih državah
   - `država` - spremenljivka: pove nam katero državo opazujemo(Slovenija, Nemčija, Italija,..)
   - `leta` - spremenljivka: pove nam, katero leto opazujemo
   - `stevilo` - spremenljivka: pove nam število brezposelnih, glede na posamezno državo

To tabelo sem dodala za bolj zanimivo analizo v zadnji fazi.
 
7. `zadnja_faza` - podatki o brezposelnosti v posameznih slovenskih občinah
   - `obcina` - spremenljivka: pove nam katero občino opazujemo(Bled, Maribor, Piran,..)
   - `leta` - spremenljivka: pove nam, katero leto opazujemo
   - `stevilo` - spremenljivka: pove nam število brezposelnih, glede na posamezno državo

***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Iz spodnjega grafa lahko razberemo, da se povečuje brezposelnost ljudi z višjo ali visokošolsko izobrazbo, kar je tudi posledica našega razvoja družbe, saj se vedno več ljudi odloča za študij. Opazimo lahko tudi, da se zmanjšuje brezposelnost ljudi, ki so brez izborazbe, imajo samo osnovnoškolsko izobrazbo ali pa nižjo ozirma srednje poklicno izobrazbo, kar je spet posledica že zgoraj omenjenega ravoja družbe.
```{r graf1, echo=FALSE, fig.align='center',warning=FALSE, fig.cap='Graf 1: Brezposelnost po izobrazbi'}
print(graf_izobrazbe)
```

Spodnji graf prikazuje brezposelnost glede na spol in iz tega grafa lahko razberemo, da je do leta 2013 bilo število brezposelnih moških večje od števila brezposelnih žensk, medtem ko se je po letu 2013 ta trend obrnil, torej je bilo več brezposelnih žensk kot moških.
Iz grafa je razvidno tudi, da se brezposelnost na splošno zmanjšuje, kar je dober znak za našo gospodarstvo.
```{r graf2, echo=FALSE, fig.align='center', warning=FALSE, fig.cap='Graf 2: Brezposelnost po spolu'}
print(graf_brezposelnost_spol)
```

Iz grafa vidimo, da so se vse brezposelnosti od leta 2011 zmanjšale, najbolj očitno pa se je zmanjšala brezposelnost enočlanskega gospodinjstva.

```{r graf3, echo=FALSE, fig.align='center', warning=FALSE, fig.cap='Graf 3: Brezposelnost glede na tip gospodinjstva'}
print(graf_tip_gospodinjstva)
```

***

Spodnji zemljevid prikazuje brezposelnost v posameznih statističnih regijah. Iz zemljevida je lepo razvidno, da je brezposelnost največja na Pomurskem, medtem ko je na Koroškem in Posavskem bistveno manjša. V Ljubljani pa je brezposelnost blizu povprečni brezposelnosti v Sloveniji leta 2017.
```{r zemljevid1, echo=FALSE, fig.align='center', warning=FALSE, fig.cap='Zemljevid 1: brezposelnost po statističnih regijah' }

ggplot() + geom_polygon(data=left_join(slovenija, regije2017, by=c("NAME_1"="regija")),
                        aes(x=long, y=lat, group=group, fill=stevilo)) +
  ggtitle("Število brezposelnih na 1000 ljudi leta 2017") + xlab("") + ylab("") 
```

Zemljevid prikazuje brezposelnost po Evropskih državah, ampak ni bilo podatkov za države Jugovzhodne Evrope in za Švico, tako da te države ne moremo vključiti v analizo brezposelnosti.
Iz zemljevida lahko razberemo, da je največ brezposelnih v Grčiji in na Poljskem. Slovenija je država, ki ima malo brezposelnih ljudi, vendar se vseeno ne more primerjati z Nemčijo ali Španijo.
```{r zemljevid2, echo=FALSE, fig.align='center', warning=FALSE, fig.cap='Zemljevid 2: Brezposelnost po Evropi'}
ggplot() + geom_polygon(data=left_join(Evropa, drzave2017, by=c("NAME"="drzava")),
                        aes(x=long, y=lat, group=group, fill=stevilo),
                        colour = "black") +
  ggtitle("Število brezposelnih v Evropi leta 2017") + xlab("") + ylab("") 
```

***

# Napredna analiza podatkov
V tej fazi sem naredila primerjavo brezposelnosti v Sloveniji glede na časovna obdobja v katerem so osebe bile nezaposlene.

```{r analiza, echo=FALSE, message=FALSE}
source("analiza/analiza.r", encoding="UTF-8")
```


#Shiny
Za na konec pa sem naredila še aplikacijo, ki prikazuje število brezposelnih ljudi v posameznih slovenskih občinah. 

```{r shiny, echo=FALSE}
shinyAppDir("shiny", options=list(width="100%", height=600))
```

